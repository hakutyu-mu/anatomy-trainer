<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anatomy National Exam Trainer (Standalone)</title>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">

    <style>
        /* CSS Content from style.css */
        :root {
            --primary: #2563eb;
            --primary-dark: #1e40af;
            --success: #10b981;
            --danger: #ef4444;
            --background: #f8fafc;
            --surface: #ffffff;
            --text: #1e293b;
            --text-light: #64748b;
            --border: #e2e8f0;
            --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            --radius: 1rem;
            --font-main: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: var(--font-main);
            background-color: var(--background);
            color: var(--text);
            line-height: 1.5;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .container {
            max-width: 800px;
            width: 100%;
            margin: 0 auto;
            padding: 1rem;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        /* Header */
        .app-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
            margin-bottom: 2rem;
        }

        .title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--primary);
        }

        .streak-badge {
            background: #ffedd5;
            color: #c2410c;
            padding: 0.25rem 0.75rem;
            border-radius: 2rem;
            font-weight: 600;
            font-size: 0.875rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Screens */
        .screen {
            display: none;
            animation: fadeIn 0.3s ease;
            flex: 1;
        }

        .screen.active {
            display: flex;
            flex-direction: column;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Home Screen */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .card {
            background: var(--surface);
            border-radius: var(--radius);
            padding: 1.5rem;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
        }

        .stats-summary {
            text-align: center;
        }

        .big-stat {
            font-size: 3rem;
            font-weight: 800;
            color: var(--primary);
            line-height: 1.2;
        }

        .stat-label {
            color: var(--text-light);
            font-size: 0.875rem;
        }

        .mode-selector {
            display: grid;
            gap: 1rem;
        }

        .btn {
            width: 100%;
            padding: 1rem;
            border: none;
            border-radius: 0.75rem;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .btn:active {
            transform: scale(0.98);
        }

        .btn-primary {
            background: var(--primary);
            color: white;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }

        .btn-primary:hover {
            background: var(--primary-dark);
        }

        .btn-secondary {
            background: white;
            border: 2px solid var(--border);
            color: var(--text);
        }

        .btn-danger {
            background: #fee2e2;
            color: #991b1b;
        }

        /* Question Screen */
        .progress-bar-container {
            height: 6px;
            background: var(--border);
            border-radius: 3px;
            margin-bottom: 2rem;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: var(--primary);
            width: 0%;
            transition: width 0.3s ease;
        }

        .question-card {
            background: var(--surface);
            padding: 2rem;
            border-radius: var(--radius);
            box-shadow: var(--shadow-lg);
            margin-bottom: 2rem;
            position: relative;
        }

        .question-text {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 2rem;
            line-height: 1.6;
        }

        .choices-grid {
            display: grid;
            gap: 1rem;
        }

        .choice-btn {
            background: var(--background);
            border: 2px solid var(--border);
            padding: 1.25rem;
            border-radius: 0.75rem;
            text-align: left;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }

        .choice-btn:hover {
            border-color: var(--primary);
            background: #eff6ff;
        }

        .choice-btn.correct {
            background: #d1fae5;
            border-color: var(--success);
            color: #064e3b;
        }

        .choice-btn.wrong {
            background: #fee2e2;
            border-color: var(--danger);
            color: #991b1b;
        }

        /* Explanation */
        .explanation-area {
            margin-top: 1.5rem;
            padding: 1.5rem;
            background: #eff6ff;
            border-radius: 0.75rem;
            border-left: 4px solid var(--primary);
            display: none;
            animation: slideDown 0.3s;
        }

        .explanation-area.visible {
            display: block;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Result Screen */
        .result-circle {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: conic-gradient(var(--primary) 0%, var(--border) 0%);
            margin: 0 auto 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .result-circle::before {
            content: '';
            position: absolute;
            width: 120px;
            height: 120px;
            background: var(--surface);
            border-radius: 50%;
        }

        .result-score {
            position: relative;
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--text);
        }

        /* Calendar */
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 4px;
            margin-top: 1rem;
        }

        .cal-header {
            font-size: 0.75rem;
            font-weight: 600;
            text-align: center;
            color: var(--text-light);
            padding-bottom: 0.5rem;
        }

        .cal-day {
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            /* Changed for stats */
            align-items: center;
            justify-content: center;
            font-size: 0.875rem;
            border-radius: 0.25rem;
            position: relative;
            border: 1px solid transparent;
        }

        .cal-day.active {
            background: #eff6ff;
            color: var(--primary);
            font-weight: 600;
        }

        .cal-day .dot {
            /* Removed dot in favor of text stats, or kept for small screens? Switched to text based on request */
            display: none;
        }

        /* Mobile Tweaks */
        @media (max-width: 600px) {
            .container {
                padding: 0.5rem;
            }

            .card {
                padding: 1rem;
            }

            .big-stat {
                font-size: 2.5rem;
            }

            .question-text {
                font-size: 1.1rem;
            }

            .choice-btn {
                padding: 1rem;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <!-- Header -->
        <header class="app-header">
            <div class="title">Anatomy Trainer (Local)</div>
            <div class="streak-badge" id="streak-count">🔥 0日連続</div>
        </header>

        <!-- Home Screen -->
        <main id="screen-home" class="screen active">
            <div class="dashboard-grid">
                <div class="card stats-summary">
                    <div class="stat-label">本日の正答率</div>
                    <div class="big-stat" id="correct-rate">0%</div>
                    <div style="font-size:0.85rem; color:var(--text-light); margin-top:0.25rem;" id="last-session-rate">
                        -</div>
                    <div class="stat-label" style="margin-top:0.5rem;">累計回答数: <span id="total-answered">0</span></div>
                </div>

                <div class="card">
                    <h3 style="margin-bottom:1rem; font-size:1rem;">学習カレンダー</h3>
                    <div id="calendar-container"></div>
                </div>
            </div>

            <div class="mode-selector">
                <button id="btn-resume" class="btn btn-primary" style="display:none; background:#8b5cf6;">
                    <span>⏯️</span> 続きから再開
                </button>
                <button id="btn-start-random" class="btn btn-primary">
                    <span>🎲</span> ランダム出題 (全104問)
                </button>
                <button id="btn-start-all" class="btn btn-secondary">
                    <span>📝</span> 順番通りに出題
                </button>
                <button id="btn-review" class="btn btn-danger">
                    <span>⚡</span> 間違えた問題のみ (0) - 復習
                </button>
            </div>

            <p style="text-align:center; margin-top:2rem; font-size:0.8rem; color:var(--text-light);">
                Ver 1.3 (Standalone) | Data Saved Locally
            </p>
        </main>

        <!-- Quiz Screen -->
        <main id="screen-quiz" class="screen">
            <div class="progress-bar-container">
                <div class="progress-bar" id="progress-bar"></div>
            </div>

            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:0.5rem;">
                <button id="btn-suspend"
                    style="background:none; border:none; color:var(--text-light); cursor:pointer; font-size:0.9rem;">
                    ⏸ 中断する
                </button>
                <div style="font-size:0.9rem; color:var(--text-light);" id="question-id">Q.1</div>
            </div>

            <div class="question-card">
                <div class="question-text" id="question-text">
                    問題文読み込み中...
                </div>

                <div class="choices-grid" id="choices-container">
                    <!-- Choices injected here -->
                </div>

                <div id="explanation-area" class="explanation-area">
                    <div style="font-weight:bold; margin-bottom:0.5rem;">解説</div>
                    <div id="explanation-text"></div>
                </div>
            </div>

            <button id="next-btn" class="btn btn-primary"
                style="display:none; position:sticky; bottom:1rem; box-shadow:0 4px 20px rgba(0,0,0,0.2);">
                次の問題へ ➜
            </button>
        </main>

        <!-- Result Screen -->
        <main id="screen-result" class="screen">
            <div class="card" style="text-align:center;">
                <h2 style="margin-bottom:2rem;">結果発表</h2>

                <div class="result-circle" id="result-circle">
                    <div class="result-score" id="result-score">80%</div>
                </div>

                <p id="result-message" style="margin-bottom:2rem; font-weight:600;">10問中 8問正解！</p>

                <div class="mode-selector">
                    <button id="btn-retry" class="btn btn-primary">もう一度挑戦</button>
                    <button id="btn-home" class="btn btn-secondary">ホームに戻る</button>
                </div>
            </div>

            <div id="wrong-list-container" style="margin-top:2rem;">
                <!-- Wrong answers list -->
            </div>
        </main>
    </div>

    <!-- Embedded Scripts -->
    <script>
        /**
 * data/questions-data.js
 * Defines the question data as a global variable to avoid CORS issues with local JSON fetching.
 */
        window.QUESTION_DATA = {
            "meta": {
                "category": "人体の構造と機能",
                "version": "1.0"
            },
            "questions": [
                {
                    "id": "A001",
                    "question": "伴性潜性遺伝（劣性遺伝）病＜X連鎖潜性遺伝（劣性遺伝）病＞はどれか。",
                    "choices": [
                        "血友病",
                        "ダウン症候群",
                        "先天性風疹症候群",
                        "フェニルケトン尿症"
                    ],
                    "answer": 0,
                    "explanation": "血友病Bや赤緑色覚異常は伴性潜性遺伝（劣性遺伝）病［X連鎖潜性遺伝（劣性遺伝）病］である。[cite: 1]"
                },
                {
                    "id": "A002",
                    "question": "健常な成人の体重における水分の割合に最も近いのはどれか。",
                    "choices": [
                        "20％",
                        "40％",
                        "60％",
                        "80％"
                    ],
                    "answer": 2,
                    "explanation": "体重における水分の割合は、成人60％、高齢者50～55％である。[cite: 1]"
                },
                {
                    "id": "A003",
                    "question": "細胞外液に比べて細胞内液で濃度が高いのはどれか。",
                    "choices": [
                        "カルシウム",
                        "ナトリウム",
                        "カリウム",
                        "クロール"
                    ],
                    "answer": 2,
                    "explanation": "カリウムイオンは細胞外液に比べて細胞内液の濃度が高い。細胞外液である血漿で4mEq/L程度、細胞内液では150mEq/L程度である。細胞外液にはナトリウムイオンが多い。[cite: 1]"
                },
                {
                    "id": "A004",
                    "question": "白血球の働きはどれか。",
                    "choices": [
                        "生体防御",
                        "血液凝固",
                        "酵素の運搬",
                        "ホルモンの運搬"
                    ],
                    "answer": 0,
                    "explanation": "白血球は体内に侵入した細菌などの異物を攻撃して生体防御を担う。特に好中球と単球は貪食作用（食作用）を持つ。[cite: 1]"
                },
                {
                    "id": "A005",
                    "question": "血液中の総ヘモグロビンに対する酸素化ヘモグロビンの割合を表すのはどれか。",
                    "choices": [
                        "酸素飽和度",
                        "動脈血酸素分圧",
                        "ヘマトクリット値",
                        "ヘモグロビン濃度"
                    ],
                    "answer": 0,
                    "explanation": "酸素飽和度は総ヘモグロビンに対する酸素と結合したヘモグロビン、つまり酸素化ヘモグロビン（オキシヘモグロビン）の割合である。％で表す。[cite: 1]"
                },
                {
                    "id": "A006",
                    "question": "血液凝固に関連するのはどれか。",
                    "choices": [
                        "ヘモグロビン",
                        "フィブリノゲン",
                        "マクロファージ",
                        "エリスロポエチン"
                    ],
                    "answer": 1,
                    "explanation": "フィブリノゲンは蛋白質であり、肝臓で生成され、血漿中でトロンビンによってフィブリンに換えられて線維状となり、血液凝固に関与する。[cite: 1]"
                },
                {
                    "id": "A007",
                    "question": "健康な成人の血液中に最も多い抗体はどれか。",
                    "choices": [
                        "IgA",
                        "IgE",
                        "IgG",
                        "IgM"
                    ],
                    "answer": 2,
                    "explanation": "IgGは液性免疫の中心である。分子量が小さく胎盤を通過できる。血液中に最も多く存在する。[cite: 1]"
                },
                {
                    "id": "A008",
                    "question": "左心室から全身に血液を送り出す血管はどれか。",
                    "choices": [
                        "冠状動脈",
                        "下大静脈",
                        "肺動脈",
                        "肺静脈",
                        "大動脈"
                    ],
                    "answer": 4,
                    "explanation": "大動脈は左心室から全身に血液を送り出す血管である。体循環は左心室→大動脈→全身→大静脈→右心房の流れである。[cite: 1]"
                },
                {
                    "id": "A009",
                    "question": "全身に動脈血を送り出すのはどれか。",
                    "choices": [
                        "右心房",
                        "右心室",
                        "左心房",
                        "左心室"
                    ],
                    "answer": 3,
                    "explanation": "全身に動脈血を送り出すのは左心室で、収縮によって大動脈へと動脈血を送り全身へと供給する。[cite: 1]"
                },
                {
                    "id": "A010",
                    "question": "部位と流れる血液との組合せで正しいのはどれか。",
                    "choices": [
                        "肺動脈　―　動脈血",
                        "肺静脈　―　静脈血",
                        "右心房　―　動脈血",
                        "左心室　―　動脈血"
                    ],
                    "answer": 3,
                    "explanation": "左心系は肺から送られた動脈血を全身に送り出すので、左心室には動脈血が流れている。[cite: 1]"
                },
                {
                    "id": "A011",
                    "question": "言語中枢があるのはどれか。",
                    "choices": [
                        "大　脳",
                        "小　脳",
                        "橋",
                        "延　髄"
                    ],
                    "answer": 0,
                    "explanation": "大脳皮質には機能局在があり、運動性言語野と感覚性言語野として大脳皮質にある。[cite: 1]"
                },
                {
                    "id": "A012",
                    "question": "交感神経の緊張状態はどれか。",
                    "choices": [
                        "瞳孔の収縮",
                        "気管支の収縮",
                        "心拍数の減少",
                        "末梢血管の収縮"
                    ],
                    "answer": 3,
                    "explanation": "交感神経の緊張（優位）状態では、皮膚などの末梢血管と、胃腸に分布する血管は収縮する。[cite: 1]"
                },
                {
                    "id": "A013",
                    "question": "正常な胃液のpHはどれか。",
                    "choices": [
                        "pH 1～2",
                        "pH 4～5",
                        "pH 7～8",
                        "pH 10～11"
                    ],
                    "answer": 0,
                    "explanation": "胃体部にある壁細胞が塩酸を分泌し、胃液はpH 1～2の強酸性である。[cite: 1]"
                },
                {
                    "id": "A014",
                    "question": "膵リパーゼが分解するのはどれか。",
                    "choices": [
                        "脂　肪",
                        "蛋白質",
                        "炭水化物",
                        "ビタミン"
                    ],
                    "answer": 0,
                    "explanation": "膵リパーゼは脂肪を分解する。膵液には他に炭水化物を分解するアミラーゼ、蛋白質を分解するトリプシンなどが含まれる。[cite: 1]"
                },
                {
                    "id": "A015",
                    "question": "腎機能の指標はどれか。",
                    "choices": [
                        "AST（GOT）",
                        "尿ビリルビン",
                        "尿素窒素（BUN）",
                        "血清アミラーゼ"
                    ],
                    "answer": 2,
                    "explanation": "尿素窒素（BUN）は蛋白質の代謝産物であり、腎臓で濾過され排泄されるため、腎機能の指標となる。[cite: 1]"
                },
                {
                    "id": "A016",
                    "question": "甲状腺機能検査を受ける患者の検査食はどれか。",
                    "choices": [
                        "ヨード制限食",
                        "蛋白制限食",
                        "脂肪制限食",
                        "低残渣食"
                    ],
                    "answer": 0,
                    "explanation": "甲状腺ホルモンの原料はヨード（ヨウ素）であるため、検査前にはヨード制限食とする。[cite: 1]"
                },
                {
                    "id": "A017",
                    "question": "外分泌器官はどれか。",
                    "choices": [
                        "副　腎",
                        "胸　腺",
                        "涙　腺",
                        "甲状腺"
                    ],
                    "answer": 2,
                    "explanation": "涙腺は涙液を分泌する外分泌器官である。副腎、胸腺、甲状腺は内分泌器官である。[cite: 1]"
                },
                {
                    "id": "A018",
                    "question": "低血糖によって分泌が促進されるのはどれか。",
                    "choices": [
                        "アルドステロン",
                        "テストステロン",
                        "甲状腺ホルモン",
                        "副腎皮質刺激ホルモン"
                    ],
                    "answer": 3,
                    "explanation": "低血糖、疼痛・不安などのストレスによって副腎皮質刺激ホルモンの分泌が促進される。[cite: 1]"
                },
                {
                    "id": "A019",
                    "question": "ホルモンを分泌するのはどれか。",
                    "choices": [
                        "前立腺",
                        "子　宮",
                        "膵　臓",
                        "肝　臓"
                    ],
                    "answer": 2,
                    "explanation": "膵臓は内分泌機能としてグルカゴン・インスリン・ソマトスタチンを分泌する。[cite: 1]"
                },
                {
                    "id": "A020",
                    "question": "脊柱で椎骨が5個なのはどれか。",
                    "choices": [
                        "頸　椎",
                        "胸　椎",
                        "腰　椎",
                        "尾　骨"
                    ],
                    "answer": 2,
                    "explanation": "頸椎は7個、胸椎は12個、腰椎は5個である。[cite: 1]"
                },
                {
                    "id": "A021",
                    "question": "精子の性染色体はどれか。",
                    "choices": [
                        "X染色体1種類",
                        "XY染色体1種類",
                        "X染色体とY染色体の2種類",
                        "XX染色体とXY染色体の2種類"
                    ],
                    "answer": 2,
                    "explanation": "精子はX染色体かY染色体のどちらかしかもたないため、X染色体とY染色体の2種類である。[cite: 1]"
                },
                {
                    "id": "A022",
                    "question": "受精卵の正常な着床部位はどれか。",
                    "choices": [
                        "卵　巣",
                        "卵　管",
                        "子宮体部",
                        "子宮頸部"
                    ],
                    "answer": 2,
                    "explanation": "正常な着床は子宮体部の内膜で行われる。[cite: 1]"
                },
                {
                    "id": "A023",
                    "question": "胎児の頭部が子宮口に最も近い胎位はどれか。",
                    "choices": [
                        "頭　位",
                        "斜　位",
                        "横　位",
                        "骨盤位"
                    ],
                    "answer": 0,
                    "explanation": "胎児の体のうち最初に産道を通る部分（先進部）が頭であるのが頭位である。[cite: 1]"
                },
                {
                    "id": "A024",
                    "question": "最終月経の初日を0日とすると分娩予定日は何日目か。",
                    "choices": [
                        "260",
                        "280",
                        "300",
                        "320"
                    ],
                    "answer": 1,
                    "explanation": "最終月経の初日を0日として40週＝280日目が予定日となる。[cite: 1]"
                },
                {
                    "id": "A025",
                    "question": "胎盤が完成する妊娠週数はどれか。",
                    "choices": [
                        "12週",
                        "16週",
                        "20週",
                        "24週"
                    ],
                    "answer": 1,
                    "explanation": "胎盤の形や機能が完成するのは15～16週である。[cite: 1]"
                },
                {
                    "id": "A026",
                    "question": "正期産とされる妊娠週数はどれか。",
                    "choices": [
                        "33週",
                        "36週",
                        "39週",
                        "42週"
                    ],
                    "answer": 2,
                    "explanation": "正期産は37週0日～41週6日までであるため、39週が該当する。[cite: 1]"
                },
                {
                    "id": "A027",
                    "question": "分娩第2期はどれか。",
                    "choices": [
                        "陣痛開始から子宮口全開大まで",
                        "排臨から発露まで",
                        "子宮口全開大から胎児娩出まで",
                        "胎児娩出から胎盤娩出まで"
                    ],
                    "answer": 2,
                    "explanation": "子宮口全開大から胎児娩出までが分娩第2期である。[cite: 1]"
                },
                {
                    "id": "A028",
                    "question": "成人の1日の平均尿量はどれか。",
                    "choices": [
                        "100mL以下",
                        "200mL～400mL",
                        "1,000mL～1,500mL",
                        "3,000mL以上"
                    ],
                    "answer": 2,
                    "explanation": "成人の1日の平均尿量は1,000～1,500mLである。[cite: 1]"
                },
                {
                    "id": "A029",
                    "question": "表在感覚の受容器が存在する部位はどれか。",
                    "choices": [
                        "筋　肉",
                        "皮　膚",
                        "関　節",
                        "骨"
                    ],
                    "answer": 1,
                    "explanation": "表在感覚（触覚・痛覚・温度覚）の受容器は皮膚や粘膜に存在する。[cite: 1]"
                },
                {
                    "id": "A030",
                    "question": "受精から着床開始までの期間はどれか。",
                    "choices": [
                        "1～2日",
                        "6～7日",
                        "13～14日",
                        "20～21日"
                    ],
                    "answer": 1,
                    "explanation": "受精後6〜7日ころに着床を開始し、さらに4日ほどかけて完了する。[cite: 1]"
                },
                {
                    "id": "A031",
                    "question": "免疫機能に関与する細胞はどれか。",
                    "choices": [
                        "血小板",
                        "白血球",
                        "網赤血球",
                        "成熟赤血球"
                    ],
                    "answer": 1,
                    "explanation": "白血球は生体防御の働きに関与しており、免疫機能をもっている。[cite: 1]"
                },
                {
                    "id": "A032",
                    "question": "月経周期が順調な場合、最終月経の初日を0日とすると分娩予定日はどれか。",
                    "choices": [
                        "240日目",
                        "280日目",
                        "320日目",
                        "360日目"
                    ],
                    "answer": 1,
                    "explanation": "分娩予定日は40週0日なので、最終月経の初日を0日として40×7＝280日である。[cite: 1]"
                },
                {
                    "id": "A033",
                    "question": "生理食塩水の塩化ナトリウム濃度はどれか。",
                    "choices": [
                        "0.9％",
                        "5％",
                        "9％",
                        "15％"
                    ],
                    "answer": 0,
                    "explanation": "生理食塩水は0.9％の濃度の塩化ナトリウム水溶液である。[cite: 1]"
                },
                {
                    "id": "A034",
                    "question": "体温を調節しているのはどれか。",
                    "choices": [
                        "橋",
                        "小　脳",
                        "中　脳",
                        "視床下部"
                    ],
                    "answer": 3,
                    "explanation": "体温調節中枢は間脳の視床下部にある。[cite: 1]"
                },
                {
                    "id": "A035",
                    "question": "成人の鼻孔から噴門までの長さで適切なのはどれか。",
                    "choices": [
                        "5～15cm",
                        "25～35cm",
                        "45～55cm",
                        "65～75cm"
                    ],
                    "answer": 2,
                    "explanation": "成人の鼻孔から噴門までの長さを合計すると約47cmとなり、45～55cmが適切である。[cite: 1]"
                },
                {
                    "id": "A036",
                    "question": "正期産の定義はどれか。",
                    "choices": [
                        "妊娠36週0日から40週6日",
                        "妊娠37週0日から41週6日",
                        "妊娠38週0日から42週6日",
                        "妊娠39週0日から43週6日"
                    ],
                    "answer": 1,
                    "explanation": "正期産は妊娠37週0日から41週6日までである。[cite: 1]"
                },
                {
                    "id": "A037",
                    "question": "内分泌器官はどれか。",
                    "choices": [
                        "乳　腺",
                        "涙　腺",
                        "甲状腺",
                        "唾液腺"
                    ],
                    "answer": 2,
                    "explanation": "甲状腺は内分泌器官であり、甲状腺ホルモンやカルシトニンを分泌する。他は外分泌器官である。[cite: 1]"
                },
                {
                    "id": "A038",
                    "question": "成人の膀胱の平均容量はどれか。",
                    "choices": [
                        "100mL",
                        "500mL",
                        "1,000mL",
                        "1,500mL"
                    ],
                    "answer": 1,
                    "explanation": "安全に膀胱に尿をためることができる量は300～600mL以下であり、該当するのは500mLである。[cite: 1]"
                },
                {
                    "id": "A039",
                    "question": "不随意筋はどれか。",
                    "choices": [
                        "心　筋",
                        "僧帽筋",
                        "大殿筋",
                        "ヒラメ筋"
                    ],
                    "answer": 0,
                    "explanation": "心筋は不随意筋である。骨格筋は随意筋である。[cite: 1]"
                },
                {
                    "id": "A040",
                    "question": "大動脈に血液を送り出す部位はどれか。",
                    "choices": [
                        "左心室",
                        "右心室",
                        "左心房",
                        "右心房"
                    ],
                    "answer": 0,
                    "explanation": "大動脈に血液を送り出すのは左心室である。[cite: 1]"
                },
                {
                    "id": "A041",
                    "question": "経腟分娩の正常な経過で最初に起こるのはどれか。",
                    "choices": [
                        "発　露",
                        "排　臨",
                        "胎盤の娩出",
                        "児頭の娩出",
                        "子宮口の全開大"
                    ],
                    "answer": 4,
                    "explanation": "分娩経過の中で最初に起こるのは分娩第1期における子宮口の全開大である。[cite: 1]"
                },
                {
                    "id": "A042",
                    "question": "神経伝達物質はどれか。",
                    "choices": [
                        "アルブミン",
                        "フィブリン",
                        "アセチルコリン",
                        "エリスロポエチン"
                    ],
                    "answer": 2,
                    "explanation": "アセチルコリンは神経伝達物質であり、交感神経、副交感神経、運動神経などから分泌される。[cite: 1]"
                },
                {
                    "id": "A043",
                    "question": "血漿と等張のブドウ糖溶液の濃度はどれか。",
                    "choices": [
                        "5％",
                        "10％",
                        "20％",
                        "50％"
                    ],
                    "answer": 0,
                    "explanation": "血漿と等張（浸透圧が等しい）のブドウ糖液は5％である。[cite: 1]"
                },
                {
                    "id": "A044",
                    "question": "嚥下に関わる脳神経はどれか。",
                    "choices": [
                        "嗅神経",
                        "外転神経",
                        "滑車神経",
                        "迷走神経"
                    ],
                    "answer": 3,
                    "explanation": "迷走神経は咽頭と喉頭の運動と感覚をつかさどり、嚥下に関与する。[cite: 1]"
                },
                {
                    "id": "A045",
                    "question": "肝臓の機能で正しいのはどれか。",
                    "choices": [
                        "胆汁の貯蔵",
                        "脂肪の吸収",
                        "ホルモンの代謝",
                        "血漿蛋白質の分解"
                    ],
                    "answer": 2,
                    "explanation": "役目を終えたホルモンは肝臓で不活化されて代謝される。[cite: 1]"
                },
                {
                    "id": "A046",
                    "question": "胆汁の作用はどれか。",
                    "choices": [
                        "殺　菌",
                        "脂肪の乳化",
                        "蛋白質の分解",
                        "炭水化物の分解"
                    ],
                    "answer": 1,
                    "explanation": "胆汁酸は脂肪を乳化させて小腸から吸収しやすくする働きがある。[cite: 1]"
                },
                {
                    "id": "A047",
                    "question": "成人の体重に占める体液の割合で最も高いのはどれか。",
                    "choices": [
                        "血　漿",
                        "間質液",
                        "細胞内液",
                        "リンパ液"
                    ],
                    "answer": 2,
                    "explanation": "細胞内液が40％で最も多い。[cite: 1]"
                },
                {
                    "id": "A048",
                    "question": "運動性言語中枢はどれか。",
                    "choices": [
                        "中心後回",
                        "大脳基底核",
                        "Broca〈ブローカ〉野",
                        "Wernicke〈ウェルニッケ〉野"
                    ],
                    "answer": 2,
                    "explanation": "優位側の大脳半球の連合野に運動性言語中枢であるブローカ野がある。[cite: 1]"
                },
                {
                    "id": "A049",
                    "question": "体温調節中枢があるのはどれか。",
                    "choices": [
                        "橋",
                        "延　髄",
                        "小　脳",
                        "大脳皮質",
                        "視床下部"
                    ],
                    "answer": 4,
                    "explanation": "視床下部の視索前野・前視床下部に体温調節中枢がある。[cite: 1]"
                },
                {
                    "id": "A050",
                    "question": "分娩時に分泌が亢進し、子宮筋を収縮させるホルモンはどれか。",
                    "choices": [
                        "エストロゲン",
                        "オキシトシン",
                        "バソプレシン",
                        "プロゲステロン"
                    ],
                    "answer": 1,
                    "explanation": "分娩時に下垂体後葉からオキシトシンが分泌され、子宮筋収縮作用と射乳作用を促す。[cite: 1]"
                },
                {
                    "id": "A051",
                    "question": "下垂体から分泌されるホルモンはどれか。",
                    "choices": [
                        "グルカゴン",
                        "プロラクチン",
                        "パラソルモン",
                        "テストステロン"
                    ],
                    "answer": 1,
                    "explanation": "プロラクチンは下垂体前葉から分泌され、乳汁産生を促進させる。[cite: 1]"
                },
                {
                    "id": "A052",
                    "question": "外分泌器官はどれか。",
                    "choices": [
                        "涙　腺",
                        "甲状腺",
                        "胸　腺",
                        "副　腎"
                    ],
                    "answer": 0,
                    "explanation": "涙腺は外分泌腺である。他は内分泌腺（またはリンパ組織）である。[cite: 1]"
                },
                {
                    "id": "A053",
                    "question": "S状結腸に造設されたストーマから通常排泄される便はどれか。",
                    "choices": [
                        "水様便",
                        "泥状便",
                        "固形便",
                        "硬　便"
                    ],
                    "answer": 2,
                    "explanation": "直腸に最も近いS状結腸の便は固形便となるのが通常である。[cite: 1]"
                },
                {
                    "id": "A054",
                    "question": "児の吸啜刺激によって分泌が亢進し、分娩後の母体の子宮筋の収縮を促すのはどれか。",
                    "choices": [
                        "オキシトシン",
                        "プロラクチン",
                        "テストステロン",
                        "プロゲステロン"
                    ],
                    "answer": 0,
                    "explanation": "オキシトシンは、児の吸啜刺激で分泌が亢進し、射乳と子宮筋の収縮（子宮復古）を促す。[cite: 1]"
                },
                {
                    "id": "A055",
                    "question": "球関節はどれか。",
                    "choices": [
                        "肩関節",
                        "膝関節",
                        "下橈尺関節",
                        "手根中手関節"
                    ],
                    "answer": 0,
                    "explanation": "肩関節は球関節であり、多軸性の運動が可能である。[cite: 1]"
                },
                {
                    "id": "A056",
                    "question": "健康な成人の1回換気量はどれか。",
                    "choices": [
                        "約150mL",
                        "約350mL",
                        "約500mL",
                        "約1,000mL"
                    ],
                    "answer": 2,
                    "explanation": "成人の1回換気量は約500mLである。[cite: 1]"
                },
                {
                    "id": "A057",
                    "question": "細菌感染による急性炎症で最初に反応する白血球はどれか。",
                    "choices": [
                        "単　球",
                        "好酸球",
                        "好中球",
                        "好塩基球",
                        "リンパ球"
                    ],
                    "answer": 2,
                    "explanation": "好中球は感染防御作用をもち、細菌感染による急性炎症では単球より早く反応する。[cite: 1]"
                },
                {
                    "id": "A058",
                    "question": "大腸で吸収されるのはどれか。",
                    "choices": [
                        "脂　質",
                        "水　分",
                        "糖　質",
                        "蛋白質"
                    ],
                    "answer": 1,
                    "explanation": "栄養素の吸収のメインは小腸で、大腸が主に吸収するのは水分である。[cite: 1]"
                },
                {
                    "id": "A059",
                    "question": "三叉神経の機能はどれか。",
                    "choices": [
                        "視　覚",
                        "眼球の運動",
                        "顔面の知覚",
                        "表情筋の運動"
                    ],
                    "answer": 2,
                    "explanation": "三叉神経は、顔面の知覚（感覚）や咀嚼運動に関与している。[cite: 1]"
                },
                {
                    "id": "A060",
                    "question": "脂肪分解酵素はどれか。",
                    "choices": [
                        "ペプシン",
                        "リパーゼ",
                        "マルターゼ",
                        "ラクターゼ"
                    ],
                    "answer": 1,
                    "explanation": "リパーゼは、脂質を脂肪酸とグリセリンに分解する。[cite: 1]"
                },
                {
                    "id": "A061",
                    "question": "後頭葉にあるのはどれか。",
                    "choices": [
                        "嗅覚野",
                        "視覚野",
                        "聴覚野",
                        "体性感覚野"
                    ],
                    "answer": 1,
                    "explanation": "視覚野は後頭葉にある。[cite: 1]"
                },
                {
                    "id": "A062",
                    "question": "胃から分泌される消化管ホルモンはどれか。",
                    "choices": [
                        "ガストリン",
                        "セクレチン",
                        "胃抑制ペプチド",
                        "コレシストキニン"
                    ],
                    "answer": 0,
                    "explanation": "ガストリンは胃幽門部にある幽門腺のG細胞から分泌される消化管ホルモンである。[cite: 1]"
                },
                {
                    "id": "A063",
                    "question": "健康な成人における1日の平均尿量はどれか。",
                    "choices": [
                        "100mL",
                        "500mL",
                        "1,500mL",
                        "2,500mL"
                    ],
                    "answer": 2,
                    "explanation": "成人の1日の平均尿量は1,000～1,500mLである。[cite: 1]"
                },
                {
                    "id": "A064",
                    "question": "健常な成人で心臓壁が最も厚いのはどれか。",
                    "choices": [
                        "右心室",
                        "右心房",
                        "左心室",
                        "左心房"
                    ],
                    "answer": 2,
                    "explanation": "左心室の心臓壁は右心室の約3倍の厚さがあり、最も厚い。[cite: 1]"
                },
                {
                    "id": "A065",
                    "question": "後腹膜器官はどれか。",
                    "choices": [
                        "胃",
                        "肝　臓",
                        "空　腸",
                        "腎　臓"
                    ],
                    "answer": 3,
                    "explanation": "腎臓は腹膜腔より後方に位置する後腹膜器官である。[cite: 1]"
                },
                {
                    "id": "A066",
                    "question": "胎児循環で胎児から胎盤に血液を送るのはどれか。",
                    "choices": [
                        "総頸動脈",
                        "肺動脈",
                        "臍動脈",
                        "臍静脈"
                    ],
                    "answer": 2,
                    "explanation": "臍動脈は胎児側から胎盤側へ老廃物や二酸化炭素を含んだ静脈血を運ぶ。[cite: 1]"
                },
                {
                    "id": "A067",
                    "question": "有害物質を無毒化し排泄する臓器はどれか。",
                    "choices": [
                        "胃",
                        "肝　臓",
                        "膵　臓",
                        "大　腸"
                    ],
                    "answer": 1,
                    "explanation": "有害物質を無毒化し排泄するのは肝臓である（例：アンモニアの尿素化）。[cite: 1]"
                },
                {
                    "id": "A068",
                    "question": "左心室から全身に血液を送り出す血管はどれか。",
                    "choices": [
                        "大静脈",
                        "大動脈",
                        "肺静脈",
                        "肺動脈"
                    ],
                    "answer": 1,
                    "explanation": "大動脈は左心室から全身に動脈血を送り出す血管である。[cite: 1]"
                },
                {
                    "id": "A069",
                    "question": "内分泌器官はどれか。",
                    "choices": [
                        "乳　腺",
                        "涙　腺",
                        "甲状腺",
                        "唾液腺"
                    ],
                    "answer": 2,
                    "explanation": "甲状腺は内分泌器官である。他は外分泌器官である。[cite: 1]"
                },
                {
                    "id": "A070",
                    "question": "呼吸中枢があるのはどれか。",
                    "choices": [
                        "間　脳",
                        "小　脳",
                        "大　脳",
                        "脳　幹"
                    ],
                    "answer": 3,
                    "explanation": "脳幹（中脳・橋・延髄）には呼吸・意識・循環などの生命維持に必要な中枢がある。[cite: 1]"
                },
                {
                    "id": "A071",
                    "question": "低体温から回復するための生体の反応はどれか。",
                    "choices": [
                        "発　汗",
                        "ふるえ",
                        "乳酸の蓄積",
                        "体表面への血流増加"
                    ],
                    "answer": 1,
                    "explanation": "ふるえは、骨格筋の不随意運動により熱産生を増加させ、体温を上昇させる反応である。[cite: 1]"
                },
                {
                    "id": "A072",
                    "question": "体性感覚はどれか。",
                    "choices": [
                        "視　覚",
                        "触　覚",
                        "聴　覚",
                        "平衡覚"
                    ],
                    "answer": 1,
                    "explanation": "皮膚や粘膜、運動器で感知される感覚を体性感覚といい、触覚はこれに含まれる。[cite: 1]"
                },
                {
                    "id": "A073",
                    "question": "健康な成人の白血球の中に占める割合が高いのはどれか。",
                    "choices": [
                        "単　球",
                        "好酸球",
                        "好中球",
                        "リンパ球"
                    ],
                    "answer": 2,
                    "explanation": "顆粒球は白血球の約65％を占め、その大部分が好中球であるため、好中球が最も割合が高い。[cite: 1]"
                },
                {
                    "id": "A074",
                    "question": "体温変化をとらえ、体温調節の指令を出すのはどれか。",
                    "choices": [
                        "橋",
                        "小　脳",
                        "視床下部",
                        "大脳皮質"
                    ],
                    "answer": 2,
                    "explanation": "視床下部は自律神経の最高中枢であり、体温調節中枢がある。[cite: 1]"
                },
                {
                    "id": "A075",
                    "question": "副交感神経の作用で正しいのはどれか。",
                    "choices": [
                        "瞳孔散大",
                        "気管支拡張",
                        "心拍数の増加",
                        "消化液分泌の促進"
                    ],
                    "answer": 3,
                    "explanation": "消化液分泌の促進は副交感神経が優位のときの作用である。他は交感神経優位の作用である。[cite: 1]"
                },
                {
                    "id": "A076",
                    "question": "心臓の刺激伝導系で最初の興奮部位はどれか。",
                    "choices": [
                        "洞房結節",
                        "房室結節",
                        "His〈ヒス〉束",
                        "Purkinje〈プルキンエ〉線維"
                    ],
                    "answer": 0,
                    "explanation": "最初に興奮するのは洞房結節（洞結節）である。[cite: 1]"
                },
                {
                    "id": "A077",
                    "question": "成人の正常な赤血球の説明で正しいのはどれか。",
                    "choices": [
                        "球状の細胞である。",
                        "腎臓で破壊される。",
                        "寿命は約60日である。",
                        "酸素の輸送を担っている。"
                    ],
                    "answer": 3,
                    "explanation": "赤血球は酸素の運搬を担っている。形状は円板状、破壊は脾臓・肝臓、寿命は約120日である。[cite: 1]"
                },
                {
                    "id": "A078",
                    "question": "肘関節を伸展させる筋肉はどれか。",
                    "choices": [
                        "三角筋",
                        "大胸筋",
                        "上腕三頭筋",
                        "上腕二頭筋"
                    ],
                    "answer": 2,
                    "explanation": "上腕三頭筋は前腕を動かし肘関節を伸展させる。[cite: 1]"
                },
                {
                    "id": "A079",
                    "question": "脳幹に含まれる部位はどれか。",
                    "choices": [
                        "延　髄",
                        "小　脳",
                        "下垂体",
                        "松果体"
                    ],
                    "answer": 0,
                    "explanation": "中脳・橋・延髄をまとめて脳幹という。[cite: 1]"
                },
                {
                    "id": "A080",
                    "question": "免疫機能に関与する細胞はどれか。",
                    "choices": [
                        "血小板",
                        "白血球",
                        "網赤血球",
                        "成熟赤血球"
                    ],
                    "answer": 1,
                    "explanation": "白血球は生体防御のはたらきに関与している。[cite: 1]"
                },
                {
                    "id": "A081",
                    "question": "上行大動脈から分枝するのはどれか。",
                    "choices": [
                        "冠状動脈",
                        "腕頭動脈",
                        "左総頸動脈",
                        "左鎖骨下動脈"
                    ],
                    "answer": 0,
                    "explanation": "上行大動脈の基部から左右の冠状動脈が分枝する。[cite: 1]"
                },
                {
                    "id": "A082",
                    "question": "膵管と合流して大十二指腸乳頭（Vater〈ファーター〉乳頭）に開口するのはどれか。",
                    "choices": [
                        "肝　管",
                        "総肝管",
                        "総胆管",
                        "胆囊管"
                    ],
                    "answer": 2,
                    "explanation": "総胆管が主膵管と合流し、大十二指腸乳頭（ファーター乳頭）に開口する。[cite: 1]"
                },
                {
                    "id": "A083",
                    "question": "正期産となる出産時期はどれか。",
                    "choices": [
                        "妊娠35週0日から39週6日",
                        "妊娠36週0日から40週6日",
                        "妊娠37週0日から41週6日",
                        "妊娠38週0日から42週6日"
                    ],
                    "answer": 2,
                    "explanation": "妊娠37週0日から41週6日までを正期産と定義している。[cite: 1]"
                },
                {
                    "id": "A084",
                    "question": "胎児循環で酸素を最も多く含む血液が流れているのはどれか。",
                    "choices": [
                        "臍静脈",
                        "臍動脈",
                        "肺静脈",
                        "肺動脈"
                    ],
                    "answer": 0,
                    "explanation": "臍静脈は、胎盤から胎児に酸素や栄養を運ぶため、酸素を多く含む血液（動脈血）が流れている。[cite: 1]"
                },
                {
                    "id": "A085",
                    "question": "眼球運動を行う神経はどれか。",
                    "choices": [
                        "視神経",
                        "外転神経",
                        "顔面神経",
                        "三叉神経"
                    ],
                    "answer": 1,
                    "explanation": "外転神経は眼球の外転をつかさどる。視神経は視覚、顔面神経は表情筋、三叉神経は顔面感覚などを担う。[cite: 1]"
                },
                {
                    "id": "A086",
                    "question": "成人の食道の構造で正しいのはどれか。",
                    "choices": [
                        "胃の幽門につながる。",
                        "上1/3が平滑筋である。",
                        "生理的狭窄部位がある。",
                        "長さは約45cmである。"
                    ],
                    "answer": 2,
                    "explanation": "食道には3つの生理的狭窄部位がある（食道入口部、気管分岐部、横隔膜貫通部）。長さは約25cmで、噴門につながる。[cite: 2]"
                },
                {
                    "id": "A087",
                    "question": "左心房と左心室の間にある弁はどれか。",
                    "choices": [
                        "三尖弁",
                        "僧帽弁",
                        "大動脈弁",
                        "肺動脈弁"
                    ],
                    "answer": 1,
                    "explanation": "僧帽弁は、左心房と左心室の間にある弁である。[cite: 2]"
                },
                {
                    "id": "A088",
                    "question": "胆汁の作用はどれか。",
                    "choices": [
                        "脂肪の乳化",
                        "蛋白質の分解",
                        "胃酸分泌の促進",
                        "炭水化物の分解"
                    ],
                    "answer": 0,
                    "explanation": "胆汁は脂肪を乳化し、消化しやすくする。[cite: 2]"
                },
                {
                    "id": "A089",
                    "question": "死の三徴候に含まれるのはどれか。",
                    "choices": [
                        "呼名反応の消失",
                        "対光反射の消失",
                        "肛門緊張の消失",
                        "深部腱反射の消失"
                    ],
                    "answer": 1,
                    "explanation": "死の三徴候とは、①心臓停止、②呼吸停止、③瞳孔散大および対光反射の消失を指す。[cite: 2]"
                },
                {
                    "id": "A090",
                    "question": "死の三徴候に含まれるのはどれか。（選択肢改変）",
                    "choices": [
                        "体温の低下",
                        "心拍の停止",
                        "筋肉の硬直",
                        "角膜の混濁"
                    ],
                    "answer": 1,
                    "explanation": "心拍の停止は死の三徴候の一つである。[cite: 2]"
                },
                {
                    "id": "A091",
                    "question": "死の三徴候に含まれるのはどれか。（選択肢改変2）",
                    "choices": [
                        "呼名反応の消失",
                        "自発呼吸の消失",
                        "随意運動の消失",
                        "深部腱反射の消失"
                    ],
                    "answer": 1,
                    "explanation": "自発呼吸の消失は死の三徴候の一つである。[cite: 2]"
                },
                {
                    "id": "A092",
                    "question": "脳死の判定基準に含まれるのはどれか。",
                    "choices": [
                        "徐　脈",
                        "除脳硬直",
                        "平坦脳波",
                        "けいれん"
                    ],
                    "answer": 2,
                    "explanation": "平坦脳波は脳死の判定基準に含まれる。[cite: 2]"
                },
                {
                    "id": "A093",
                    "question": "臓器の移植に関する法律における脳死の判定基準に含まれるのはどれか。",
                    "choices": [
                        "低体温",
                        "心停止",
                        "平坦脳波",
                        "下顎呼吸"
                    ],
                    "answer": 2,
                    "explanation": "平坦脳波が脳死の判定基準に該当する。心停止は死の三徴候に該当する。[cite: 2]"
                },
                {
                    "id": "A094",
                    "question": "死の三徴候に基づいて観察するのはどれか。",
                    "choices": [
                        "腹壁反射",
                        "輻輳反射",
                        "対光反射",
                        "深部腱反射"
                    ],
                    "answer": 2,
                    "explanation": "死の三徴候の一つとして対光反射の消失があるため、対光反射を観察する。[cite: 2]"
                },
                {
                    "id": "A095",
                    "question": "臓器の移植に関する法律における脳死の判定基準で正しいのはどれか。",
                    "choices": [
                        "瞳孔径は左右とも3mm以上",
                        "脳波上徐波の出現",
                        "微弱な自発呼吸",
                        "脳幹反射の消失",
                        "浅昏睡"
                    ],
                    "answer": 3,
                    "explanation": "判定基準では脳幹反射の消失が必要である。瞳孔径は4mm以上、脳波は平坦、自発呼吸は消失、深昏睡が必要である。[cite: 2]"
                },
                {
                    "id": "A096",
                    "question": "死の三徴候に含まれるのはどれか。（選択肢改変3）",
                    "choices": [
                        "筋の弛緩",
                        "角膜の混濁",
                        "呼吸の停止",
                        "呼名反応の消失"
                    ],
                    "answer": 2,
                    "explanation": "呼吸の停止は死の三徴候に含まれる。[cite: 2]"
                },
                {
                    "id": "A097",
                    "question": "脳死の判定基準に含まれないのはどれか。",
                    "choices": [
                        "深昏睡",
                        "心停止",
                        "脳幹反射の消失",
                        "自発呼吸の消失"
                    ],
                    "answer": 1,
                    "explanation": "心停止していたら脳死ではなく死亡していることになるため、脳死判定基準には含まれない（心拍動があることが前提）。[cite: 2]"
                },
                {
                    "id": "A098",
                    "question": "脳死の状態はどれか。",
                    "choices": [
                        "縮瞳がある。",
                        "脳波で徐波がみられる。",
                        "自発呼吸は停止している。",
                        "痛み刺激で逃避反応がある。"
                    ],
                    "answer": 2,
                    "explanation": "脳死状態では自発呼吸消失が確認される。また、瞳孔散大、平坦脳波、深昏睡（反応なし）が特徴である。[cite: 2]"
                },
                {
                    "id": "A099",
                    "question": "臓器の移植に関する法律において脳死の判定基準となっている検査はどれか。",
                    "choices": [
                        "脳波検査",
                        "筋電図検査",
                        "神経伝導検査",
                        "脳脊髄液検査"
                    ],
                    "answer": 0,
                    "explanation": "脳死判定の項目には脳波検査が含まれ、平坦な脳波を確認する。[cite: 2]"
                }
            ]
        };

        // --- storageManager.js ---
        const STORAGE_KEY = 'anatomy_trainer_v1';
        const defaultData = {
            stats: { totalAttempts: 0, totalCorrect: 0, totalQuestions: 0 },
            dailyLog: {},
            streak: { current: 0, max: 0, lastLoginDate: null },
            perfectClear: {},
            wrongHistory: {},
            resumeData: null,
            lastSession: null
        };

        class StorageManager {
            constructor() {
                this.data = this._loadData();
            }
            _loadData() {
                try {
                    const stored = localStorage.getItem(STORAGE_KEY);
                    if (stored) { return { ...defaultData, ...JSON.parse(stored) }; }
                } catch (e) {
                    console.warn('LocalStorage access failed:', e);
                }
                return JSON.parse(JSON.stringify(defaultData));
            }
            _saveData() {
                try {
                    localStorage.setItem(STORAGE_KEY, JSON.stringify(this.data));
                } catch (e) {
                    console.warn('LocalStorage save failed:', e);
                }
            }
            saveResumeData(sessionData) {
                this.data.resumeData = sessionData;
                this._saveData();
            }
            loadResumeData() {
                return this.data.resumeData;
            }
            clearResumeData() {
                this.data.resumeData = null;
                this._saveData();
            }
            saveLastSessionStats(correct, total) {
                this.data.lastSession = {
                    correct: correct,
                    total: total,
                    rate: Math.round((correct / total) * 100),
                    date: Date.now()
                };
                this._saveData();
            }
            getLastSessionStats() {
                return this.data.lastSession;
            }
            updateStats(isCorrect, questionId) {
                this.data.stats.totalAttempts++;
                this.data.stats.totalQuestions++;
                if (isCorrect) {
                    this.data.stats.totalCorrect++;
                    if (this.data.wrongHistory[questionId]) { delete this.data.wrongHistory[questionId]; }
                    this.data.perfectClear[questionId] = true;
                } else {
                    this.data.wrongHistory[questionId] = Date.now();
                }
                this._updateDailyLog(isCorrect);
                this._saveData();
            }
            _updateDailyLog(isCorrect) {
                const today = new Date().toISOString().split('T')[0];
                if (!this.data.dailyLog[today]) {
                    this.data.dailyLog[today] = { attempts: 0, correctCount: 0, totalCount: 0, correctRate: 0 };
                    this._updateStreak(today);
                }
                const log = this.data.dailyLog[today];
                log.attempts++;
                log.totalCount++;
                if (isCorrect) log.correctCount++;
                log.correctRate = Math.round((log.correctCount / log.totalCount) * 100);
            }
            _updateStreak(today) {
                const lastLogin = this.data.streak.lastLoginDate;
                if (lastLogin === today) return;
                const yesterday = new Date();
                yesterday.setDate(yesterday.getDate() - 1);
                const yesterdayStr = yesterday.toISOString().split('T')[0];
                if (lastLogin === yesterdayStr) { this.data.streak.current++; } else { this.data.streak.current = 1; }
                if (this.data.streak.current > this.data.streak.max) { this.data.streak.max = this.data.streak.current; }
                this.data.streak.lastLoginDate = today;
            }
            getWrongQuestions() { return Object.keys(this.data.wrongHistory); }
            getData() { return this.data; }
            resetData() { this.data = JSON.parse(JSON.stringify(defaultData)); this._saveData(); }
        }

        // --- soundManager.js ---
        class SoundManager {
            constructor() {
                this.enabled = true;
                this.context = null;
                try {
                    this.context = new (window.AudioContext || window.webkitAudioContext)();
                } catch (e) {
                    console.warn('Web Audio API not supported:', e);
                }
            }
            toggle(state) {
                this.enabled = state !== undefined ? state : !this.enabled;
                return this.enabled;
            }
            play(type) {
                if (!this.enabled || !this.context) return;
                this._playSynth(type);
            }
            _playSynth(type) {
                if (this.context.state === 'suspended') { this.context.resume().catch(e => console.log('Audio resume failed', e)); }
                const oscillator = this.context.createOscillator();
                const gainNode = this.context.createGain();
                oscillator.connect(gainNode);
                gainNode.connect(this.context.destination);

                if (type === 'correct') {
                    oscillator.type = 'sine';
                    oscillator.frequency.setValueAtTime(880, this.context.currentTime);
                    oscillator.frequency.exponentialRampToValueAtTime(1760, this.context.currentTime + 0.1);
                    gainNode.gain.setValueAtTime(0.3, this.context.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, this.context.currentTime + 0.3);
                    oscillator.start();
                    oscillator.stop(this.context.currentTime + 0.3);
                } else if (type === 'wrong') {
                    oscillator.type = 'sawtooth';
                    oscillator.frequency.setValueAtTime(150, this.context.currentTime);
                    oscillator.frequency.linearRampToValueAtTime(100, this.context.currentTime + 0.3);
                    gainNode.gain.setValueAtTime(0.3, this.context.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, this.context.currentTime + 0.3);
                    oscillator.start();
                    oscillator.stop(this.context.currentTime + 0.3);
                } else if (type === 'finish') {
                    const now = this.context.currentTime;
                    [523.25, 659.25, 783.99, 1046.50].forEach((freq, i) => {
                        const osc = this.context.createOscillator();
                        const gain = this.context.createGain();
                        osc.connect(gain);
                        gain.connect(this.context.destination);
                        osc.frequency.value = freq;
                        gain.gain.setValueAtTime(0.2, now + i * 0.1);
                        gain.gain.exponentialRampToValueAtTime(0.001, now + i * 0.1 + 0.4);
                        osc.start(now + i * 0.1);
                        osc.stop(now + i * 0.1 + 0.4);
                    });
                }
            }
        }

        // --- questionManager.js ---
        class QuestionManager {
            constructor() {
                this.questions = [];
                this.currentQueue = [];
                this.currentIndex = 0;
            }
            async loadQuestions() {
                // Check global variable first (CORS safe way)
                if (window.QUESTION_DATA) {
                    this.questions = window.QUESTION_DATA.questions;
                    return true;
                }
                return false;
            }
            initMode(mode, wrongIds = []) {
                this.currentIndex = 0;
                if (mode === 'review') {
                    this.currentQueue = this.questions.filter(q => wrongIds.includes(q.id));
                } else {
                    this.currentQueue = [...this.questions];
                }
                if (mode === 'random') { this._shuffle(this.currentQueue); }
            }
            _shuffle(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
            }
            getCurrentQuestion() { if (this.currentIndex >= this.currentQueue.length) return null; return this.currentQueue[this.currentIndex]; }
            next() { this.currentIndex++; return this.currentIndex < this.currentQueue.length; }
            getProgress() { return { current: this.currentIndex + 1, total: this.currentQueue.length }; }
        }

        // --- calendarManager.js ---
        class CalendarManager {
            constructor(storageManager) { this.storage = storageManager; }
            generateCalendarHTML(year, month) {
                const data = this.storage.getData();
                const logs = data.dailyLog;
                const now = new Date();
                const y = year || now.getFullYear();
                const m = month !== undefined ? month : now.getMonth();
                const firstDay = new Date(y, m, 1);
                const lastDay = new Date(y, m + 1, 0);
                const daysInMonth = lastDay.getDate();
                const startDay = firstDay.getDay();
                let html = '<div class="calendar-grid">';
                const days = ['日', '月', '火', '水', '木', '金', '土'];
                days.forEach(d => html += `<div class="cal-header">${d}</div>`);
                for (let i = 0; i < startDay; i++) { html += '<div class="cal-day empty"></div>'; }
                for (let d = 1; d <= daysInMonth; d++) {
                    const dateStr = `${y}-${String(m + 1).padStart(2, '0')}-${String(d).padStart(2, '0')}`;
                    const log = logs[dateStr];
                    let classes = 'cal-day';
                    if (log) { classes += ' active'; }
                    html += `<div class="${classes}" data-date="${dateStr}">
                    <span class="day-num">${d}</span>
                    ${log ? `<div style="font-size:0.6rem; margin-top:2px;">${log.correctRate}%</div>` : ''}
                </div>`;
                }
                html += '</div>';
                return html;
            }
        }

        // --- app.js ---
        const app = {
            init: async () => {
                try {
                    console.log("App initializing...");
                    app.storage = new StorageManager();
                    app.sound = new SoundManager();
                    app.questions = new QuestionManager();
                    app.calendar = new CalendarManager(app.storage);

                    const loaded = await app.questions.loadQuestions();
                    if (!loaded) {
                        console.error("Critical: Failed to load question data.");
                        alert("データの読み込みに失敗しました。詳細についてはブラウザのコンソール（F12）を確認してください。");
                        return;
                    }
                    console.log("Data loaded successfully.");

                    app.dom = {
                        screens: document.querySelectorAll('.screen'),
                        home: document.getElementById('screen-home'),
                        quiz: document.getElementById('screen-quiz'),
                        result: document.getElementById('screen-result'),
                        streakCount: document.getElementById('streak-count'),
                        totalAnswered: document.getElementById('total-answered'),
                        correctRate: document.getElementById('correct-rate'),
                        calendarContainer: document.getElementById('calendar-container'),
                        reviewBtn: document.getElementById('btn-review'),
                        progressBar: document.getElementById('progress-bar'),
                        questionText: document.getElementById('question-text'),
                        choicesContainer: document.getElementById('choices-container'),
                        explanationArea: document.getElementById('explanation-area'),
                        explanationText: document.getElementById('explanation-text'),
                        nextBtn: document.getElementById('next-btn'),
                        questionIdDisplay: document.getElementById('question-id'),
                        resultScore: document.getElementById('result-score'),
                        resultCircle: document.getElementById('result-circle'),
                        resultMessage: document.getElementById('result-message'),
                        wrongList: document.getElementById('wrong-list-container')
                    };

                    app.renderHome();
                    app.switchScreen('home');

                    document.getElementById('btn-start-random').addEventListener('click', () => { console.log('Random Clicked'); app.startQuiz('random'); });
                    document.getElementById('btn-start-all').addEventListener('click', () => { console.log('All Clicked'); app.startQuiz('sequential'); });

                    const resumeBtn = document.getElementById('btn-resume');
                    if (resumeBtn) {
                        resumeBtn.addEventListener('click', () => app.startQuiz('resume'));
                    }

                    app.dom.reviewBtn.addEventListener('click', () => app.startQuiz('review'));
                    app.dom.nextBtn.addEventListener('click', () => app.nextQuestion());
                    document.getElementById('btn-suspend').addEventListener('click', () => app.suspendQuiz());
                    document.getElementById('btn-home').addEventListener('click', () => {
                        app.renderHome();
                        app.switchScreen('home');
                    });
                    document.getElementById('btn-retry').addEventListener('click', () => app.startQuiz('random'));

                    console.log("App initialization complete.");
                } catch (error) {
                    console.error("App Initialization Failed:", error);
                    alert("アプリの初期化中にエラーが発生しました: " + error.message);
                }
            },

            renderHome: () => {
                const data = app.storage.getData();
                const stats = data.stats;

                // Calculate Today's Correct Rate
                const today = new Date().toISOString().split('T')[0];
                const log = data.dailyLog[today];
                const rate = log ? log.correctRate : 0; // Usage of "Today's Rate" as requested

                // Last Session Rate
                const lastSession = app.storage.getLastSessionStats();
                const lastRateText = lastSession ? `前回: ${lastSession.rate}%` : '前回: -';

                app.dom.streakCount.textContent = `${data.streak.current}日連続`;
                app.dom.totalAnswered.textContent = stats.totalQuestions;
                app.dom.correctRate.textContent = `${rate}% (今日)`;

                // Inject Last Session
                let lastSessionEl = document.getElementById('last-session-rate');
                if (!lastSessionEl) {
                    // If it doesn't exist yet (first load of standalone v1.3), create it
                    const correctRateEl = document.getElementById('correct-rate');
                    lastSessionEl = document.createElement('div');
                    lastSessionEl.id = 'last-session-rate';
                    lastSessionEl.style.fontSize = '0.85rem';
                    lastSessionEl.style.color = 'var(--text-light)';
                    lastSessionEl.style.marginTop = '0.25rem';
                    correctRateEl.after(lastSessionEl);
                }
                lastSessionEl.textContent = lastRateText;

                // Update Calendar
                app.dom.calendarContainer.innerHTML = app.calendar.generateCalendarHTML();

                const wrongCount = app.storage.getWrongQuestions().length;
                app.dom.reviewBtn.innerHTML = `<span>⚡</span> 間違えた問題のみ (${wrongCount}) - 復習`;
                if (wrongCount === 0) {
                    app.dom.reviewBtn.disabled = true;
                    app.dom.reviewBtn.style.opacity = '0.5';
                } else {
                    app.dom.reviewBtn.disabled = false;
                    app.dom.reviewBtn.style.opacity = '1';
                }

                // Resume visibility
                const resumeData = app.storage.loadResumeData();
                const resumeBtn = document.getElementById('btn-resume');
                if (resumeData) {
                    resumeBtn.style.display = 'flex';
                    resumeBtn.innerHTML = `<span>⏯️</span> 続きから再開 (Q.${resumeData.progress.current})`;
                } else {
                    resumeBtn.style.display = 'none';
                }
            },

            startQuiz: (mode) => {
                if (mode === 'resume') {
                    const data = app.storage.loadResumeData();
                    if (data) {
                        app.session = data.session;
                        app.questions.currentQueue = data.queue;
                        app.questions.currentIndex = data.currentIndex;
                        app.storage.clearResumeData();
                        app.renderQuestion();
                        app.switchScreen('quiz');
                        return;
                    }
                }

                const wrongIds = app.storage.getWrongQuestions();
                app.questions.initMode(mode, wrongIds);
                app.session = { correct: 0, total: 0, mode: mode, wrongQuestions: [] };
                app.renderQuestion();
                app.switchScreen('quiz');
            },

            suspendQuiz: () => {
                const progress = app.questions.getProgress();
                const resumeData = {
                    session: app.session,
                    queue: app.questions.currentQueue,
                    currentIndex: app.questions.currentIndex,
                    progress: progress
                };
                app.storage.saveResumeData(resumeData);
                app.renderHome();
                app.switchScreen('home');
            },

            renderQuestion: () => {
                const q = app.questions.getCurrentQuestion();
                if (!q) { app.finishQuiz(); return; }
                const progress = app.questions.getProgress();
                app.dom.progressBar.style.width = `${((progress.current - 1) / progress.total) * 100}%`;
                app.dom.questionIdDisplay.textContent = `Q.${progress.current} / ${progress.total}`;
                app.dom.questionText.textContent = q.question;
                app.dom.choicesContainer.innerHTML = '';
                app.dom.explanationArea.classList.remove('visible');
                app.dom.nextBtn.style.display = 'none';

                // Shuffle choices
                const choicesWithIndex = q.choices.map((choice, idx) => ({
                    text: choice,
                    originalIndex: idx
                }));

                // Fisher-Yates shuffle
                for (let i = choicesWithIndex.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [choicesWithIndex[i], choicesWithIndex[j]] = [choicesWithIndex[j], choicesWithIndex[i]];
                }

                // Find new position of correct answer
                app.currentCorrectIndex = choicesWithIndex.findIndex(item => item.originalIndex === q.answer);

                // Render shuffled choices
                choicesWithIndex.forEach((item, index) => {
                    const btn = document.createElement('button');
                    btn.className = 'choice-btn';
                    btn.textContent = item.text;
                    btn.onclick = () => app.handleAnswer(index, btn);
                    app.dom.choicesContainer.appendChild(btn);
                });
            },

            handleAnswer: (selectedIndex, btnElement) => {
                if (app.dom.nextBtn.style.display === 'block') return;
                const q = app.questions.getCurrentQuestion();
                const isCorrect = selectedIndex === app.currentCorrectIndex;
                const buttons = app.dom.choicesContainer.querySelectorAll('.choice-btn');
                buttons[app.currentCorrectIndex].classList.add('correct');
                if (!isCorrect) { btnElement.classList.add('wrong'); app.session.wrongQuestions.push(q); }
                app.session.total++;
                if (isCorrect) app.session.correct++;
                app.storage.updateStats(isCorrect, q.id);
                app.sound.play(isCorrect ? 'correct' : 'wrong');
                app.dom.explanationText.textContent = q.explanation;
                app.dom.explanationArea.classList.add('visible');
                app.dom.nextBtn.style.display = 'block';
                setTimeout(() => { app.dom.nextBtn.scrollIntoView({ behavior: 'smooth', block: 'nearest' }); }, 300);
            },

            nextQuestion: () => {
                if (app.questions.next()) { app.renderQuestion(); } else { app.finishQuiz(); }
            },

            finishQuiz: () => {
                app.sound.play('finish');
                app.switchScreen('result');
                const rate = Math.round((app.session.correct / app.session.total) * 100) || 0;

                // Save Last Session Stats
                app.storage.saveLastSessionStats(app.session.correct, app.session.total);

                app.dom.resultScore.textContent = `${rate}%`;
                app.dom.resultCircle.style.background = `conic-gradient(var(--primary) ${rate}%, var(--border) ${rate}%)`;
                app.dom.resultMessage.textContent = `${app.session.total}問中 ${app.session.correct}問正解！`;
                if (app.session.wrongQuestions.length > 0) {
                    app.dom.wrongList.innerHTML = '<h3>復習リスト</h3>' + app.session.wrongQuestions.map(q =>
                        `<div class="card" style="margin-top:0.5rem; padding:1rem;">
                    <div style="font-weight:bold; font-size:0.9rem; margin-bottom:0.25rem;">${q.question}</div>
                    <div style="font-size:0.85rem; color:var(--text-light);">${q.explanation}</div>
                </div>`
                    ).join('');
                } else {
                    app.dom.wrongList.innerHTML = '<div style="text-align:center; padding:2rem;">🎉 全問正解！素晴らしい！</div>';
                }
            },

            switchScreen: (screenName) => {
                app.dom.screens.forEach(s => s.classList.remove('active'));
                app.dom[screenName].classList.add('active');
            }
        };

        window.onload = app.init;
    </script>
</body>

</html>